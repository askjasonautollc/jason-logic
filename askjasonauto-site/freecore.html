<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Core Plan – Ask Jason Auto</title>

  <!-- 🟢 PWA Manifest + Theme Color -->
  <link rel="manifest" href="/manifest.json" />
  <meta name="theme-color" content="#000000">

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Space+Grotesk:wght@700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script async src="https://www.googletagmanager.com/gtag/js?id=AW-17130303914"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'AW-17130303914');
  </script>
  <script src="https://cdn.usefathom.com/script.js" data-site="BZGXIYBC" defer></script>
  <style>
    body {
      background-color: #0B0B0B;
      font-family: 'Inter', sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    .lime {
      color: #C7F21D;
    }
    .bg-lime {
      background-color: #C7F21D;
    }
    .hover\:bg-lime-dark:hover {
      background-color: #b1d81c;
    }
    .spinner {
      border: 4px solid rgba(255, 255, 255, 0.1);
      border-top: 4px solid #C7F21D;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: auto;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    .formkit-modal.guard {
      display: flex !important;
      justify-content: center;
      align-items: center;
    }
    .formkit-submitted-message,
    .formkit-form[data-uid="cac1668b94"] .formkit-return-visitor {
      text-align: center;
      margin-top: 2rem;
      font-size: 1rem;
      font-weight: 500;
      color: #C7F21D;
    }
    #nav-buttons {
      transition: transform 0.3s ease;
    }
  </style>
</head>
<body class="text-white text-base leading-relaxed sm:text-base">
  <div class="bg-yellow-600 text-black text-sm text-center py-2 px-4 font-medium shadow-md z-50">
    🚧 Pardon our mess as we optimize. 💡 We want to give you the best deals as soon as possible. 🚀 Massive Launch Coming July 4th! 🎉
  </div>

  <div id="nav-buttons" class="max-w-4xl mx-auto px-4 py-4 flex justify-center gap-4 sticky top-0 z-40">
    <a href="/" class="bg-gray-700 hover:bg-gray-600 text-white font-medium px-4 py-2 rounded-lg shadow transition">Home</a>
    <a href="/redflag" class="bg-red-500 text-black font-bold px-4 py-2 rounded-lg shadow hover:bg-red-400 transition">Red Flag of the Day</a>
  </div>

 <div class="max-w-4xl mx-auto px-4 py-6">
  <div class="bg-gray-800 rounded-2xl shadow-xl px-4 py-6 sm:px-8 sm:py-10 text-center">
    <h1 class="text-3xl font-bold lime mb-4" style="font-family: 'Space Grotesk', sans-serif;">Ask Jason; What's The Deal?</h1>
    <div class="w-full flex justify-center mb-4">
      <img 
        src="https://github.com/askjasonautollc/jason-logic/blob/5dc34b38877c0ceca58d1171d1091a233bd7e0da/ChatGPT%20Image%20May%2027%2C%202025%2C%2003_06_09%20PM.png?raw=true" 
        alt="Ask Jason Auto Logo" 
        class="h-20 sm:h-24 object-contain rounded-md shadow-md"
      />
    </div>
    <p class="text-gray-300 text-base sm:text-lg mb-6" style="font-family: 'Space Grotesk', sans-serif;">
      Enter as much as you know—Jason can handle the blanks. Just drop in what you’ve got. Even just a screen shot of the ad! Report populates below to save or print in seconds.
    </p>
</div>

     <form id="evaluationForm" class="space-y-6" enctype="multipart/form-data">
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-300 mb-1">Your Role</label>
            <select name="role" class="w-full rounded-lg p-3 bg-gray-700 text-white border border-gray-600 text-sm">
              <option>Buyer</option>
              <option>Seller</option>
              <option>Flipper</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-300 mb-1">Repair Skill</label>
            <select name="repairSkill" class="w-full rounded-lg p-3 bg-gray-700 text-white border border-gray-600 text-sm">
             <option value="diy">DIY – I fix my own</option>
             <option value="shop">Shop – I pay for repairs</option>
            </select>
          </div>
        </div>

      <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
 <div>
  <label class="block text-sm font-medium text-gray-300 mb-1">
    Year <span class="text-red-500">*</span>
  </label>
  <select name="year" id="year" required
    class="w-full rounded-lg p-3 bg-gray-700 text-white border border-gray-600 text-sm invalid:border-red-500 focus:invalid:ring-red-500">
    <option value="">Select Year</option>
    <!-- 2025 down to 1950 -->
    <option value="2025">2025</option>
    <option value="2024">2024</option>
    <option value="2023">2023</option>
    <option value="2022">2022</option>
    <option value="2021">2021</option>
    <option value="2020">2020</option>
    <option value="2019">2019</option>
    <option value="2018">2018</option>
    <option value="2017">2017</option>
    <option value="2016">2016</option>
    <option value="2015">2015</option>
    <option value="2014">2014</option>
    <option value="2013">2013</option>
    <option value="2012">2012</option>
    <option value="2011">2011</option>
    <option value="2010">2010</option>
    <option value="2009">2009</option>
    <option value="2008">2008</option>
    <option value="2007">2007</option>
    <option value="2006">2006</option>
    <option value="2005">2005</option>
    <option value="2004">2004</option>
    <option value="2003">2003</option>
    <option value="2002">2002</option>
    <option value="2001">2001</option>
    <option value="2000">2000</option>
    <option value="1999">1999</option>
    <option value="1998">1998</option>
    <option value="1997">1997</option>
    <option value="1996">1996</option>
    <option value="1995">1995</option>
    <option value="1994">1994</option>
    <option value="1993">1993</option>
    <option value="1992">1992</option>
    <option value="1991">1991</option>
    <option value="1990">1990</option>
    <option value="1989">1989</option>
    <option value="1988">1988</option>
    <option value="1987">1987</option>
    <option value="1986">1986</option>
    <option value="1985">1985</option>
    <option value="1984">1984</option>
    <option value="1983">1983</option>
    <option value="1982">1982</option>
    <option value="1981">1981</option>
    <option value="1980">1980</option>
    <option value="1979">1979</option>
    <option value="1978">1978</option>
    <option value="1977">1977</option>
    <option value="1976">1976</option>
    <option value="1975">1975</option>
    <option value="1974">1974</option>
    <option value="1973">1973</option>
    <option value="1972">1972</option>
    <option value="1971">1971</option>
    <option value="1970">1970</option>
    <option value="1969">1969</option>
    <option value="1968">1968</option>
    <option value="1967">1967</option>
    <option value="1966">1966</option>
    <option value="1965">1965</option>
    <option value="1964">1964</option>
    <option value="1963">1963</option>
    <option value="1962">1962</option>
    <option value="1961">1961</option>
    <option value="1960">1960</option>
    <option value="1959">1959</option>
    <option value="1958">1958</option>
    <option value="1957">1957</option>
    <option value="1956">1956</option>
    <option value="1955">1955</option>
    <option value="1954">1954</option>
    <option value="1953">1953</option>
    <option value="1952">1952</option>
    <option value="1951">1951</option>
    <option value="1950">1950</option>
  </select>
</div>

 <div>
  <label class="block text-sm font-medium text-gray-300 mb-1">
    Make <span class="text-red-500">*</span>
  </label>
  <select name="make" id="make" required
    class="w-full rounded-lg p-3 bg-gray-700 text-white border border-gray-600 text-sm invalid:border-red-500 focus:invalid:ring-red-500">
    <option value="">Select Make</option>
    <option value="Acura">Acura</option>
    <option value="Alfa Romeo">Alfa Romeo</option>
    <option value="Aston Martin">Aston Martin</option>
    <option value="Audi">Audi</option>
    <option value="BMW">BMW</option>
    <option value="Buick">Buick</option>
    <option value="Cadillac">Cadillac</option>
    <option value="Chevrolet">Chevrolet</option>
    <option value="Chrysler">Chrysler</option>
    <option value="Dodge">Dodge</option>
    <option value="Ferrari">Ferrari</option>
    <option value="Fiat">Fiat</option>
    <option value="Ford">Ford</option>
    <option value="GMC">GMC</option>
    <option value="Genesis">Genesis</option>
    <option value="Honda">Honda</option>
    <option value="Hyundai">Hyundai</option>
    <option value="Infiniti">Infiniti</option>
    <option value="Jaguar">Jaguar</option>
    <option value="Jeep">Jeep</option>
    <option value="Kia">Kia</option>
    <option value="Land Rover">Land Rover</option>
    <option value="Lexus">Lexus</option>
    <option value="Lincoln">Lincoln</option>
    <option value="Maserati">Maserati</option>
    <option value="Mazda">Mazda</option>
    <option value="Mercedes-Benz">Mercedes‑Benz</option>
    <option value="Mercury">Mercury</option>
    <option value="Mini">Mini</option>
    <option value="Mitsubishi">Mitsubishi</option>
    <option value="Nissan">Nissan</option>
    <option value="Pontiac">Pontiac</option>
    <option value="Porsche">Porsche</option>
    <option value="Ram">Ram</option>
    <option value="Subaru">Subaru</option>
    <option value="Tesla">Tesla</option>
    <option value="Toyota">Toyota</option>
    <option value="Volkswagen">Volkswagen</option>
    <option value="Volvo">Volvo</option>
  </select>
</div>

  <div>
    <label class="block text-sm font-medium text-gray-300 mb-1">
      Model <span class="text-red-500">*</span>
    </label>
    <input name="model" placeholder="Model (e.g. Focus)" required
      class="peer w-full p-3 rounded bg-gray-700 text-white border border-gray-600 text-sm invalid:border-red-500 focus:invalid:ring-red-500" />
  </div>
</div>

<div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mt-4">
  <div>
    <label class="block text-sm font-medium text-gray-300 mb-1">
      ZIP Code <span class="text-red-500">*</span>
    </label>
    <input name="zip" type="text" placeholder="ZIP Code (5 digits)" required pattern="\d{5}" maxlength="5"
      class="peer w-full p-3 rounded bg-gray-700 text-white border border-gray-600 text-sm invalid:border-red-500 focus:invalid:ring-red-500" />
  </div>

  <div>
    <label class="block text-sm font-medium text-gray-300 mb-1">
      Price <span class="text-red-500">*</span>
    </label>
    <input name="price" type="number" placeholder="Price (USD)" required min="1"
      class="peer w-full p-3 rounded bg-gray-700 text-white border border-gray-600 text-sm invalid:border-red-500 focus:invalid:ring-red-500" />
  </div>

  <div>
    <label class="block text-sm font-medium text-gray-300 mb-1">
      Mileage <span class="text-red-500">*</span>
    </label>
    <input name="mileage" type="number" placeholder="Mileage" required min="1"
      class="peer w-full p-3 rounded bg-gray-700 text-white border border-gray-600 text-sm invalid:border-red-500 focus:invalid:ring-red-500" />
  </div>
</div>

<div class="mt-4">
  <label class="block text-sm font-medium text-gray-300 mb-1">
    Condition Notes <span class="text-red-500">*</span>
  </label>
  <textarea name="conditionNotes" id="conditionNotes" rows="4" required data-minwords="10"
    placeholder="Describe issues, seller notes, asking price, platform..."
    class="peer w-full rounded-lg p-3 bg-gray-700 text-white border border-gray-600 text-sm invalid:border-red-500 focus:invalid:ring-red-500"></textarea>
  <p id="notesError" class="text-red-500 text-sm mt-1 hidden">Please enter at least 10 words in the condition notes.</p>
</div>
        <input type="file" name="photos" id="photos" multiple accept="image/*" class="w-full text-gray-300 text-sm" onchange="if(this.files.length > 2){ alert('Max 2 photos allowed'); this.value = ''; }" />

        <div class="text-center">
          <button type="submit" class="bg-lime text-black font-bold px-6 py-2 rounded-md shadow hover:bg-lime-dark transition">Submit for Evaluation</button>
        </div>
      </form>

      <div id="submittedMessage" class="hidden mt-6 text-center text-gray-300 text-lg">
        <p class="text-lime text-xl font-semibold">We got it. Jason’s running the numbers.</p>
        <p class="text-sm text-gray-400 mt-1">Hang tight — your custom report is coming up.</p>
        <div class="mt-6 flex justify-center gap-4 flex-wrap">
          <a href="https://www.askjasonauto.com" class="bg-gray-700 hover:bg-gray-600 text-white font-medium px-4 py-2 rounded-lg shadow transition">Return to Home</a>
          <a href="https://www.askjasonauto.com/freecore" class="bg-lime text-black font-bold px-4 py-2 rounded-lg shadow hover:bg-lime-dark transition">Run Another Deal</a>
        </div>
      </div>
    </div>

    <div id="loading" class="mt-10 hidden text-center">
      <div class="bg-gray-800 p-6 rounded-lg shadow-lg">
        <div class="spinner"></div>
        <p class="mt-4 text-lime text-lg font-semibold">Results pending…</p>
        <p class="text-sm text-gray-400">Jason’s crunching the numbers. Hang tight.</p>
      </div>
    </div>

    <div id="output" class="mt-10 bg-gray-900 text-gray-100 rounded-lg p-6 hidden prose prose-invert max-w-none text-base leading-7 sm:text-lg"></div>

    <div id="reportActions" class="hidden mt-6 text-center">
      <button onclick="window.print()" class="bg-lime text-black font-bold px-6 py-2 rounded-md shadow hover:bg-lime-dark transition">
        🖨️ Print or Save Report
      </button>
    </div>
  </div>

  <script>
    const form = document.getElementById('evaluationForm');
    const output = document.getElementById('output');
    const loading = document.getElementById('loading');
    const submittedMsg = document.getElementById('submittedMessage');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      form.classList.add('hidden');
      submittedMsg.classList.remove('hidden');
      output.classList.add('hidden');
      output.innerHTML = "";
      loading.classList.remove('hidden');

      const formData = new FormData(form);

      try {
        const response = await fetch('https://jason-logic.vercel.app/api/submitEvaluation', {
          method: 'POST',
          body: formData
        });

        const raw = await response.text();
        let result = {};
        try {
          result = JSON.parse(raw);
        } catch (parseErr) {
          output.innerHTML = "<p class='text-red-400'>❌ Response was not valid JSON.</p>";
          loading.classList.add('hidden');
          output.classList.remove('hidden');
          return;
        }

        loading.classList.add('hidden');

        if (result?.report && typeof result.report === 'string') {
          const raw = result.report;
          const html = raw
            .replace(/\*\*(.*?)\*\*/g, '<strong class="text-white">$1</strong>')
            .replace(/## (.*?)\n/g, '<h2 class="text-lime-400 text-xl font-semibold mt-6 mb-2">$1</h2>')
            .replace(/# (.*?)\n/g, '<h1 class="text-lime-400 text-2xl font-bold mt-8 mb-4">$1</h1>')
            .replace(/- (.*?)(?=\n|$)/g, '<li>$1</li>')
            .replace(/\n{2,}/g, '</p><p>')
            .replace(/\n/g, '<br>')
            .replace(/<li>(.*?)<\/li>/g, '<ul class="list-disc list-inside space-y-1 mb-4"><li>$1</li></ul>')
            .replace(/```(.*?)```/gs, '<pre class="bg-gray-800 text-sm p-4 rounded mb-4">$1</pre>');

          output.innerHTML = `
            <div class="space-y-6 text-sm text-gray-300 leading-relaxed bg-gray-900 rounded-xl p-6 shadow-lg">
              ${html}
            </div>
          `;
          document.getElementById('reportActions').classList.remove('hidden');
        } else {
          output.innerHTML = "<p class='text-yellow-300'>⚠️ No readable report returned. Check logs or backend response.</p>";
        }

output.classList.remove('hidden');
} catch (err) {
  loading.classList.add('hidden');
  output.innerHTML = `<p class='text-red-400'>❌ Submit failed: ${err.message}</p>`;
  output.classList.remove('hidden');
}
});
</script>

<!-- ConvertKit Centered Inline Embed -->
<div class="flex justify-center mt-12">
  <script async data-uid="cac1668b94" src="https://ask-jason-auto.kit.com/cac1668b94/index.js"></script>
</div>

<!-- Scroll-aware nav buttons -->
<script>
  const navButtons = document.getElementById('nav-buttons');
  let lastScrollY = window.scrollY;
  window.addEventListener('scroll', () => {
    const currentScrollY = window.scrollY;
    if (currentScrollY > lastScrollY + 10) {
      navButtons.style.transform = 'translateY(-100%)';
    } else if (currentScrollY < lastScrollY - 10) {
      navButtons.style.transform = 'translateY(0)';
    }
    lastScrollY = currentScrollY;
  });
</script>
<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/service-worker.js')
      .then(reg => console.log('✅ Service Worker registered:', reg))
      .catch(err => console.error('❌ Service Worker registration failed:', err));
  }
</script>
<script>
  if (!localStorage.getItem("aja_session_id")) {
    const sessionId = crypto.randomUUID();
    localStorage.setItem("aja_session_id", sessionId);
  }
</script>
